# 流动性挖矿原理

```alert type=caution title=注意
本文是普及金融市场交易的基础知识，不是为了鼓励大家去炒股炒币。相反，通过学习证券知识，理解衍生品原理，可以更好地认识市场风险，自觉放弃杠杆赌博暴富等不切实际的幻想，避免落入各种理财、带单、空气币等诈骗套路。本文一切内容均不构成任何投资意见或建议。
```

流动性挖矿被称为Liquidity Mining，或者Yield Farming，是DeFi领域的一个创新。

我们这里不讨论流动性挖矿到底好还是不好，是不是骗局。因为币圈的无监管特性，任何“创新”都可以直接写代码实施，流动性挖矿也是如此。

最早启动流动性挖矿的项目已经不好考证，但是让流动性挖矿一夜火爆起来的是[Compound](https://compound.finance/)这个借贷项目。后来Sushi复制了Uniswap V2的代码，通过搞流动性挖矿，一度成功地把Uniswap的流动性给吸走了大部分。

因为Compound的流动性挖矿是基于它的借贷模式，为了便于大家理解，我们用[Sushi](https://sushi.com/)来解释流动性挖矿的原理，因为Sushi的代码和Uniswap是完全一样的，对于Swap，我们通过对Uniswap的AMM机制剖析，得出结论如下：

1. 一个交易池需要LP放入两种资产，才能实现AMM，让交易员实现Swap交易；
2. 一个LP放入两种资产到交易池后，他会得到相应数量的代币作为LP凭证，这个代币通常就称为LP，因为稍后可以用LP提取前期放入的流动性资产并获取手续费收入。注意到每个交易池对应的LP凭证代币都是不同的，不能用A池的LP代币去B池提取流动性。

手续费是激励LP放入流动性的关键。手续费通常为0.1%～0.3%，其中大部分归LP，小部分由项目本身收取以支付开发运营费用等。

Swap的手续费虽然看上去比传统的撮合交易要高几倍，但是链上交易频率较低，如果交易额度不是很大，手续费实际收入是很少的。越是交易额低的池子，手续费收入越低，做LP的人越少，反过来导致交易额越低。

因此，如何激励LP，尤其是没有什么流动性的新交易池，就是一个大问题。

我们来看看Sushi的流动性挖矿，是如何激励LP的。

假设一个新的交易池ETH/USDC没有什么流动性，为了鼓励大家去做LP，Sushi引入了一种锁仓挖矿的方式：

1. 一个做市商放入ETH/USDC后，获得相应数量的LP；
2. 不要在手里持有LP，而是把LP质押到挖矿合约中，此合约按照设定的规则，按质押金额和质押时长发放奖励，奖励的代币就是SUSHI；
3. 一段时间后，从挖矿合约中解除质押，获得SUSHI奖励，再把解除质押的LP用于提取流动性资产，获得ETH/USDC以及手续费。

由于存在挖矿，因此收益除了手续费，还额外多了挖矿奖励SUSHI。把SUSHI卖掉，那就是双份奖励，自然收获双份快乐。

我们假设第一步投入总价值$10000的资产到交易池，获得10000个LP，再假定10000个LP放入挖矿合约中，每天收获100个SUSHI，一个SUSHI如果是$0.1，那么投入$10000，每天的挖矿收入就是$10，日收益率0.1%，年化收益率36.5%。

但是，且慢，SUSHI也是凭空发出的代币，你挖我挖他也挖，挖出来你卖我卖他也卖，很快就能把SUSHI卖成$0.01，$0.001，直到归零。

不下点套，能让你随随便便卖掉挖出来的SUSHI？

怎么下套？这就是流动性挖矿的“精髓”所在。

对ETH/USDC这种普通的交易池，每10000个LP每日可挖出100个SUSHI，这叫普通矿池。

还有一种交易池，SUSHI/USDC，每10000个LP每日可挖出1000个SUSHI，这叫超级矿池。

那谁会挖普通矿池啊，当然是直接挖超级矿池了！

看仔细了，超级矿池是SUSHI/USDC，为了能挖超级矿池，首先要获得它的LP，而它的LP需要注入的资产是SUSHI和USDC。

一开始挖矿的时候，大家手里有SUSHI么？

为了挖超级矿池，你得先挖普通矿池，等待一段时间，获得SUSHI奖励后，不能把SUSHI卖掉，而是再用USDC配对，去SUSHI/USDC做LP，才能挖超级矿池。

这就是老司机说的一池、二池。一池就是普通矿池，二池就是奖励加倍的超级矿池。

下图就是如何在手里没有SUSHI的情况下先在一池挖矿，再去二池挖矿，以便获得更高的收益：

```ascii
                 ┌──────┐
                 │      ▼
   ETH  USDC     │    SUSHI USDC
    │    │       │      │    │
    ▼    ▼       │      ▼    ▼
┌─────────────┐  │  ┌─────────────┐
│Swap:        │  │  │Swap:        │
│ETH/USDC     │  │  │SUSHI/USDC   │
└─────────────┘  │  └─────────────┘
       │         │         │
  ETH-USDC-LP    │   SUSHI-USDC-LP
       │         │         │
       ▼         │         ▼
┌─────────────┐  │  ┌─────────────┐
│Mining:      │──┘  │Mining:      │──▶ SUSHI
│ETH-USDC-LP  │     │SUSHI-USDC-LP│
└─────────────┘     └─────────────┘
```

也有人会想，既然大家手里都没有SUSHI，要挖二池就要有SUSHI，但是挖一池获得SUSHI奖励太费时间，我直接去SUSHI/USDC池子里买点SUSHI，买到了SUSHI直接挖二池它不香么？

恭喜你有这样聪明的头脑。回顾上文我们讲Uniswap的`x * y = k`恒乘积公式，买入SUSHI就会直接推高SUSHI的价格，比如把SUSHI从$0.1买到了$1。

这个时候，一池矿工的收益率就从年化36.5%直接变成了365%，二池的收益率更不得了了，这会导致更多的人冲进来挖矿。更多的人去买SUSHI，导致SUSHI价格更高，比如涨到$10，挖矿收益率更高，如此反复循环。

那SUSHI不得涨到天上去？那也不会，因为矿池每天的产出是固定的。比如一池每天产出100个SUSHI，一个人投入$10000每天收获100个SUSHI，但是另一个人也投入$10000，两人每天就各自只能收获50个SUSHI了。因此，随着矿工的涌入，挖矿收益率会降低，低到一个程度，某些矿工就会主动撤退。

撤退的矿工会将手里的SUSHI卖出以获得实际的挖矿收益。有的人在$1的价格卖出，有的人在$10的价格卖出。随着挖出的SUSHI越来越多，必然有越来越多的矿工开始抛售SUSHI，直到某个时间点，卖出的SUSHI比买入的SUSHI多，SUSHI价格开始下降。

这一降不要紧，关键是收益率随之下降。一旦价格下跌的预期形成，矿工就会争先恐后地抛售SUSHI，SUSHI价格也随之断崖下跌，收益率砍掉一个0或者两个0不叫个事儿，老司机称这种现象叫“矿塌了”。

所以流动性挖矿是短期内迅速实现冷启动的一种模式，通过激励，短期内迅速获得大量用户。但是它的泡沫来得快去得也快，早期的矿工获得的收益实际上是由高位接盘的后期买家支付的，参与流动性挖矿一定要认清潜在的风险，包括合约漏洞的风险，不能被表面虚高的年化收益率给蒙蔽了双眼。

也有人会想，这么好的一本万利的生意，为什么以前没有赌场做？这是因为区块链的数学加密算法保证了计算公开透明，没有任何人能篡改规则。大家只有在确信规则透明可靠的情况下，才会参与这个游戏。如果是传统的网站，能随意修改数据库，自然不会有人相信这个游戏规则本身是公平的。

可以肯定的是，大多数流动性挖矿的项目，最终除了早期矿工，肯定是发行代币的项目方大赚特赚。但我们也应该看到流动性挖矿的积极一面：如果一个类似Uniswap的项目可以长期稳定地运行，且项目收益定期分配给持有UNI的投资人，那么流动性挖矿也是一种早期代币分发的机制，因为早期流动性挖矿的矿工作为参与者为项目提供了大量流动性，客观上推动了项目的快速发展。事实上Uniswap也搞过一段时间的流动性挖矿。

通过本文的讲解，关于流动性挖矿，相信各位童鞋已经理解了它的原理。
